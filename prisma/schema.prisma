// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

// Simple workout session model matching your Google Sheets structure
model WorkoutSession {
  id           String   @id @default(cuid())
  date         DateTime
  source       String   // "Peloton", "Cannondale", "Tonal", etc.
  activity     String   // "Cycling", "Weight Lifting", etc.
  minutes      Int      // Duration in minutes
  miles        Float?   // Distance for cardio activities
  weightLifted Float?   // Total weight lifted for strength training
  notes        String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("workout_sessions")
}

// Goal tracking for quarterly and annual targets
model Goal {
  id                    String   @id @default(cuid())
  type                  GoalType // QUARTERLY or ANNUAL
  year                  Int
  quarter               Int?     // For quarterly goals (1-4)
  targetMinutes         Int?
  targetSessions        Int?
  targetSessionsPerWeek Int?
  targetWeeksPerQuarter Int?
  targetAnnualGoal      Int?
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  @@map("goals")
}

// Monthly summaries (auto-calculated from workout sessions)
model MonthlySummary {
  id            String   @id @default(cuid())
  year          Int
  month         Int      // 1-12
  totalMinutes  Int
  totalMiles    Float
  totalSessions Int
  averageWeight Float?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@unique([year, month])
  @@map("monthly_summaries")
}

enum GoalType {
  QUARTERLY
  ANNUAL
}